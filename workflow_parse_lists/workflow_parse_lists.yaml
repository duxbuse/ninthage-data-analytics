# Uses 666654103849-compute@developer.gserviceaccount.com
main:
    params: [input]
    steps:
        - workflow_function_data_conversion:
            call: http.post
            args:
                url: https://us-central1-ninthage-data-analytics.cloudfunctions.net/function_data_conversion
                headers:
                    Content-type: application/json
                body:
                    data: ${input}
                auth:
                    type: OIDC
                result: json_file

        - workflow_function_upload_data_into_bigquery:
            call: http.post
            args:
                url: https://us-central1-ninthage-data-analytics.cloudfunctions.net/function_upload_data_into_bigquery
                headers:
                    Content-type: application/json
                body:
                    json_file: ${json_file}
                auth:
                    type: OIDC

    # - checkSearchTermInInput:
    #     switch:
    #         - condition: ${"searchTerm" in input}
    #           assign:
    #             - searchTerm: ${input.searchTerm}
    #           next: readWikipedia
    # - getCurrentTime:
    #     call: http.get
    #     args:
    #         url: https://us-central1-workflowsample.cloudfunctions.net/datetime
    #     result: currentDateTime
    # - setFromCallResult:
    #     assign:
    #         - searchTerm: ${currentDateTime.body.dayOfTheWeek}
    # - readWikipedia:
    #     call: http.get
    #     args:
    #         url: https://en.wikipedia.org/w/api.php
    #         query:
    #             action: opensearch
    #             search: ${searchTerm}
    #     result: wikiResult

    # - returnOutput:
    #         return: ${wikiResult.body[1]}
